<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editar Usuário</title>
    <link rel="stylesheet" href="/style.css">
</head>
<body>
    <h1><img class="page-icon" src="/icons/user.svg" alt="Usuário"> Editar Usuário</h1>

    <form action="/usuarios/editar" method="POST">
        <input type="hidden" name="id_usuario" value="<%= usuario.id_usuario || usuario.id %>">

         <label>Nome Completo</label>
         <input id="nomeUsuarioEdit" type="text" name="nome" value="<%= usuario.nome %>" required>
         <span id="warningNomeUsuarioEdit" class="warning" role="alert">O nome não pode conter números.</span>

         <label>Matrícula</label>
         <input id="matriculaUsuarioEdit" type="text" name="matricula" value="<%= usuario.matricula %>" required>
         <span id="warningMatriculaUsuarioEdit" class="warning" role="alert">A matrícula deve conter apenas números.</span>

        <label>Email</label>
        <input type="email" name="email" value="<%= usuario.email %>" required>

        <button type="submit">Salvar Alterações</button>
    </form>

    <a href="/usuarios">Cancelar</a>
    <script>
        (function(){
            const nome = document.getElementById('nomeUsuarioEdit');
            const matricula = document.getElementById('matriculaUsuarioEdit');
            const warnNome = document.getElementById('warningNomeUsuarioEdit');
            const warnMat = document.getElementById('warningMatriculaUsuarioEdit');
            const form = document.querySelector('form[action="/usuarios/editar"]');

            function validarNome() {
                const hasDigit = /\d/.test(nome.value);
                warnNome.classList.toggle('show', hasDigit);
                return !hasDigit;
            }

            function validarMatricula() {
                const hasNonDigit = /\D/.test(matricula.value);
                warnMat.classList.toggle('show', hasNonDigit);
                return !hasNonDigit && matricula.value.trim() !== '';
            }

            nome.addEventListener('input', validarNome);
            matricula.addEventListener('input', validarMatricula);

            form.addEventListener('submit', function(e){
                const okNome = validarNome();
                const okMat = validarMatricula();
                if (!okNome || !okMat) {
                    e.preventDefault();
                    (okNome ? matricula : nome).focus();
                }
            });
        })();
    </script>
</body>
</html>